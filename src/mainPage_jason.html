<!DOCTYPE html>
<html lang="en">

<head>
<title>Take Your Pills</title>
<link rel="stylesheet" type="text/css" href="layout_jason.css" />
<link rel="stylesheet" type="text/css" href="external-lib/bootstrap/css/bootstrap.min.css" />
<script type = "text/javascript" src= "external-lib/jquery-1.9.0.min.js"> </script>
<script type = "text/javascript" src= "external-lib/jquery-ui-1.10.0.custom.min.js"> </script>
<script src="myDrug.js"></script>

<script type="text/javascript">
	var actionQueue = [];
	var displayQueue = [];
	var hiddenDrugQueue = [];
	var drugsQueue=[];
	$(document).ready(function() {
    	
    	$(".checkbox").click(function(evt){
  		if ($("input:checked").length != 0){
  			$("#actionbar").show();
  		} else {
  			$("#actionbar").hide();
  		};

  		$("#take").click(function(evt){
  			$("input:checked").parent().parent().remove();
  		});

  		$("#miss").click(function(evt){
  			$("input:checked").parent().parent().remove();
  		});

  		});

  		$('#EditPills').click(function(evt){
  			document.getElementById("home").style.display="none";
  			document.getElementById("add_new").style.display="none";
			document.getElementById("edit_main").style.display="block";
			document.getElementById("edit_title").innerHTML="Edit Your Pills";
  		})

  		$("#add").click(function(evt){
  			var row = document.createElement('tr');
  			var td1 = document.createElement('td');
  			$(td1).append($(document.createElement('input')).attr('type','checkbox').addClass('checkbox'));
  			$(td1).append("DrugD");
  			$(row).append($(td1));
  			$(row).append($(document.createElement('td')).append('3/18/13'));
  			$(row).append($(document.createElement('td')).append('8:00pm'));
  			$(row).append($(document.createElement('td')).append('2pills'));
  			$(row).append($(document.createElement('td')).append($(document.createElement('button')).addClass('btn').addClass('btn-info').append('info')));
  			$(row).addClass("success").addClass('drug');
  			$('#drugtable').append($(row));

  			$(".checkbox").click(function(evt){
  				if ($("input:checked").length != 0){
  			$("#actionbar").show();
  			} else {
  				$("#actionbar").hide();
  			};

  			$("#take").click(function(evt){
  				$("input:checked").parent().parent().remove();
  			});

  			$("#miss").click(function(evt){
  				$("input:checked").parent().parent().remove();
  			});

  			});

  		});
	});
		
	/*
	This is the start of Ty's javascript
	*/

			$(function() {
				document.getElementById("edit_main").style.display="none";
				document.getElementById("add_new").style.display="none";
				document.getElementById("cycle").style.display="block";
				document.getElementById("specific_time").style.display="none";
				document.getElementById("num_dosage").style.display="none";

			
				function editPill() { // for each drug button on Edit Your Pills page
				document.getElementById("edit_main").style.display="none";
				document.getElementById("add_new").style.display="block";
				document.getElementById("edit_title").innerHTML="Edit Pill";
									
				}
				
				// in Add New Pill
				$( "#add_startdate" ).datepicker();
				$( "#add_enddate" ).datepicker();
				
				// TODO: fix bug here (reset to default)
				$( "#add_dosefrequency" ).change(function() {
					if ($(this).val()==0) {
						document.getElementById("cycle").style.display="block";
						document.getElementById("specific_time").style.display="none";
						document.getElementById("num_dosage").style.display="none";
					}
					else if ($(this).val()==1) {
						document.getElementById("cycle").style.display="none";
						document.getElementById("specific_time").style.display="block";
						document.getElementById("num_dosage").style.display="none";
					}
					else {
						document.getElementById("cycle").style.display="none";
						document.getElementById("specific_time").style.display="none";
						document.getElementById("num_dosage").style.display="block";
					}
				});
				
			});
						
			function redirectToHome() {
				document.getElementById("edit_main").style.display="none";
				document.getElementById("add_new").style.display="none";
				document.getElementById("edit_title").innerHTML="";
				document.getElementById('home').style.display='block';
			}
			
			function changeDivToAddNewDrug() {
				document.getElementById("edit_main").style.display="none";
				document.getElementById("add_new").style.display="block";
				document.getElementById("edit_title").innerHTML="Add New Pill";
			}
			
			function backToEdit() {
				var noSave=confirm("Your changes have not been saved. Do you still want to go back to Edit My Pills page?");
				if (noSave==true) {
					clear_add_new();
					document.getElementById("add_new").style.display="none";
					document.getElementById("edit_main").style.display="block";
					document.getElementById("edit_title").innerHTML="Edit Your Pills";
				}
			}
			
			function save_new() {
				var pdiv = document.createElement("div");
				pdiv.setAttribute("id",document.getElementById("new_drugname").value+"_pdiv");

				var del = document.createElement("input");
				del.setAttribute("type", "button");
				del.setAttribute("value", "-");
				del.setAttribute("id", document.getElementById("new_drugname").value);
				del.setAttribute("onclick", "deletePill(this);");
				
				var newButton = document.createElement("input");
				newButton.setAttribute("type", "button");
				newButton.setAttribute("value", document.getElementById("new_drugname").value);
				
				pdiv.appendChild(newButton);
				pdiv.appendChild(del);
				document.getElementById("drug_section").appendChild(pdiv);
				
				// save info into shared object function
				var pillTimes;
				if (document.getElementById("add_dosefrequency").value==0) { // cycle = two numbers
					pillTimes=document.getElementById("cycle_hour").value+","+document.getElementById("cycle_minute").value;
				}
				else if (document.getElementById("add_dosefrequency").value==1) { // specific time = innerHTML type string
					pillTimes=document.getElementById("selected_times").innerHTML; // <p>some:time am</p> listed

				}
				else { // number of doses per day = one number (1-10)

					pillTimes=document.getElementById("num_hour").value;
				}

				var myPill=new myDrug(document.getElementById("new_drugname").value, document.getElementById("new_drugdose").value, document.getElementById("add_startdate").value, document.getElementById("add_enddate").value, document.getElementById("new_drugname").value, document.getElementById("add_dosefrequency").value, pillTimes);

				drugsQueue.push(myPill);
				
				clear_add_new();
				document.getElementById("add_new").style.display="none";
				document.getElementById("edit_main").style.display="block";
				document.getElementById("edit_title").innerHTML="Edit Your Pills";
			}
			
			function clear_add_new() {
				document.getElementById("new_drugname").value="";
				document.getElementById("new_drugdose").value="";
				document.getElementById("add_startdate").value="";
				document.getElementById("add_enddate").value="";
				document.getElementById("selected_times").innerHTML="";
			}
			
			function addSpecificTime() {
				var p = document.createElement("p");
				p.innerHTML=document.getElementById("specific_hour").value+" : "+document.getElementById("specific_minute").value+" "+document.getElementById("am_pm").value;
				
				var selected=document.getElementById("selected_times");
				selected.appendChild(p);
			
			}
			
			function clearSpecificTime() {
				document.getElementById("selected_times").innerHTML="";
			
			}

			function deletePill(ele) {
				var parent=document.getElementById("drug_section");
				var child=document.getElementById(ele.id+"_pdiv");
				parent.removeChild(child);

				drugsQueue = drugsQueue.filter(function(pill){
  return pill.name !== ele.id;
});
					
			}
		</script>
</head>

<body>
	<div class="row">
	<div class=" header span6 centered">
			<h4 class="header_text">Take Your Pills</h4>
	</div>
	</div>

	<div class="row">
	<div class= "span6 centered" id="contact-doctor-bar">
			<button class= "btn btn-primary" id="home_btn"> Home</button>
			<button class= "btn btn-warning" id="contact_doctor_btn"> Contact Doctor</button>
			<span>2:00pm 4/20/2013</span>
			<button class= "btn" id="contact_doctor_btn"> Sign Out</button>
    </div>
	</div>

	<div id="home">
	

	
	<div class="row" >
		<div class="span6 centered">
			See History
		</div>
	</div>
	<div class="row">
		<label class="span2">
		<input type = "checkbox"> Select missed
		</label>
		<button id="EditPills" class= "btn btn-primary span2 offset1"> Edit pills
		</button>
		<button class= "btn span1" id="add"> <i class="icon-plus"></i></button>
	</div>
	<div class="row">
		<div class="span6" id="main">
		<div id="drugs">
		<table class= "table" id="drugtable">
			<tr class="error drug">
				<td> <input type = "checkbox" class="checkbox"> DrugA   </td>
				<td> 3/18/13 </td>
				<td> 2:00pm </td>
				<td>  2pills </td>
				<td>  <button class="btn btn-info"> info </button> 
				</td>
			</tr>
			<tr class="error drug">
				<td> <input type = "checkbox" class="checkbox"> DrugB  </td>
				<td> 3/18/13 </td>
				<td> 4:00pm </td>
				<td>  2pills </td>
				<td>  <button class="btn btn-info"> info </button> 
				</td>
			</tr>

			<tr class="success drug">
				<td> <input type = "checkbox" class="checkbox"> DrugB  </td>
				<td> 3/18/13 </td>
				<td> 6:00pm </td>
				<td>  2pills </td>
				<td>  <button class="btn btn-info"> info </button> 
				</td>
			</tr>
		</table>
		</div>
		<div class="row" id="showmore">
		<button class= "btn-block"> see more pills </button>
		</div>
		<div class="row" id="actionbar">
			<button class="btn btn-success span2" id="take"> Take </button>
			<button class="btn btn-warning span2 offset2" id="miss"> Miss </button>
		</div>
		</div>
		
	</div>
	</div>

	<h1 id="edit_title"></h1>
	<div id="edit_main">
		<input type="button" id="edit_to_home" onclick="redirectToHome()" value="Back to Home">
		
		<div id="drug_section">
		</div>
			
		<input type="button" id="add_new_drug" onclick="changeDivToAddNewDrug()" value="+">
	</div>
		
		
	<div id="add_new">

		<input type="button" id="back_to_edit" onclick="backToEdit()" value="Back to Edit">

		<div id="add_new_section">
			<p>New Pill Name: <input type="text" id="new_drugname" /></p>
			<p>Dose: <input type="text" id="new_drugdose" /></p>
			<p>Start Date: <input type="text" id="add_startdate" /></p>
			<p>End Date: <input type="text" id="add_enddate" /></p>
			<p>Dose Frequency: <select id="add_dosefrequency">
				  <option value="0">Set Cycle</option>
				  <option value="1">Set Specific Time</option>
				  <option value="2">Set Number of Dose(s) Per Day</option>
			</select></p>

			<div id="cycle">
				<p>Take every <select id="cycle_hour">
				  <option value="0">0</option>
				  <option value="1">1</option>
				  <option value="2">2</option>
				  <option value="3">3</option>
				  <option value="4">4</option>
				  <option value="5">5</option>
				  <option value="6">6</option>
				  <option value="7">7</option>
				  <option value="8">8</option>
				  <option value="9">9</option>
				  <option value="10">10</option>
				  <option value="11">11</option>
				  <option value="12">12</option>
				  <option value="13">13</option>
				  <option value="14">14</option>
				  <option value="16">15</option>
				  <option value="16">16</option>
				  <option value="17">17</option>
				  <option value="18">18</option>
				  <option value="19">19</option>
				  <option value="20">20</option>
				  <option value="21">21</option>
				  <option value="22">22</option>
				  <option value="23">23</option>
			</select> hour(s), and <select id="cycle_minute">
				  <option value="0">0</option>
				  <option value="15">15</option>
				  <option value="30">30</option>
				  <option value="45">45</option>
			</select> minute(s)
			</p>
			</div>
			<div id="specific_time">
				Take every day at: <div id="selected_times"></div>
				<p><select id="specific_hour">
				  <option value="1">1</option>
				  <option value="2">2</option>
				  <option value="3">3</option>
				  <option value="4">4</option>
				  <option value="5">5</option>
				  <option value="6">6</option>
				  <option value="7">7</option>
				  <option value="8">8</option>
				  <option value="9">9</option>
				  <option value="10">10</option>
				  <option value="11">11</option>
				  <option value="12">12</option>
			</select> : <select id="specific_minute">
				  <option value="00">00</option>
				  <option value="15">15</option>
				  <option value="30">30</option>
				  <option value="45">45</option>
			</select> <select id="am_pm">
				  <option value="am">am</option>
				  <option value="pm">pm</option>
			</select>
			</p>
			<p><input type="button" id="clear_specific" onclick="clearSpecificTime()" value="Clear Times"> <input type="button" id="add_specific" onclick="addSpecificTime()" value="Add This Time"></p>
			</div>
			<div id="num_dosage">
				<p>Take <select id="num_hour">
				  <option value="1">1</option>
				  <option value="2">2</option>
				  <option value="3">3</option>
				  <option value="4">4</option>
				  <option value="5">5</option>
				  <option value="6">6</option>
				  <option value="7">7</option>
				  <option value="8">8</option>
				  <option value="9">9</option>
				  <option value="10">10</option>
			</select> time(s) per day
			</div>
			<p><input type="button" id="save_new" onclick="save_new()" value="Save New Pill"></p>
			
		</div>
	</div>


</body>

</html>
